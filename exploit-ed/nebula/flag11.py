def main():
        # Method 1:
        plaintext = "getflag"
        # Step 1
        key = (0xff & 1024) # initial key is equal to 0
        ciphertext = chr(ord(plaintext[0]) ^ key)
        # Next Steps
        
        for i in range(1,len(plaintext)):
            key -= ord(plaintext[i-1])
            temp = (key ^ ord(plaintext[i])) & 0xff
            ciphertext += (chr(temp))
        #print(ciphertext)
        
        # Conduct the check
        key = 0
        check = ""
        for i in range(len(ciphertext)):
            check += chr((key ^ ord(ciphertext[i])) & 0xff)
            key -= ord(ciphertext[i]) 
        #print(check)

        header = "Content-Length: 1024\n"
        payload = header + ciphertext + ("\x00" * (1023 - len(ciphertext))) + "\x00"
        print(payload)

if __name__ == '__main__':
        main()

