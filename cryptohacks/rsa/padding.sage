from pwn import *
from sage.all import *
# sage: sage -python3 -m pip install pwntools
import json
from Crypto.Util.number import long_to_bytes

# Useful: https://crypto.stackexchange.com/questions/95065/breaking-rsa-with-linear-padding-using-hastads-attack-with-e-11

HOST = 'socket.cryptohack.org'
def bespoke_padding():

	# a = []
	# b = []
	# c = []
	# n = []
	# g = []

	# # Extracting values
	# count = 11
	# PORT = 13386
	# # r = remote(HOST, PORT)
	# # p = r.recvuntil("flag.\n")
	# data = {'option': 'get_flag'}
	# payload = json.dumps(data)
	# for i in range(count):
	# 	print('-' * 50)
	# 	r = remote(HOST, PORT)
	# 	p = r.recvuntil("flag.\n")
	# 	r.sendline(payload)
	# 	p = json.loads(r.recvline())
	# 	pad_var = p['padding']
	# 	mod = p['modulus']
	# 	enc = p['encrypted_flag']
	# 	print(pad_var, mod, enc)
	# 	a.append(pad_var[0])
	# 	b.append(pad_var[1])
	# 	c.append(enc)
	# 	n.append(mod)
		# aii = inverse_mod(a[i], n[i])
		# g.append((x + b[i] * aii)^11 - c[i] * aii^11)

	# f = open('bespoke_values.txt', 'w')
	# f.write(str(a))
	# f.write("\n\n")
	# f.write(str(b))
	# f.write("\n\n")
	# f.write(str(c))
	# f.write("\n\n")
	# f.write(str(n))
	# f.write("\n\n")

	a = [3426303541360300925532641863262642680114986866911699253177506064516156294837028482273281766777966689821629965740613140040325444815555709077861436451453172901660077931577181955183280993659954692271400809180475034508384657353036988379782805933414864480251661913459754615466181065609190923995201259632166430037868415901422863309888436618074623672124621546002719521980569188488092600004426078285723947707116962121399679595233795820874999854523929054965464883445964943696907168336979331733399921197848595378708908045097176946986579207610595592191108598738199008579139865385673742528476420560094880190064605499252092300159, 10758799269834112739976567901407903273535156434654427015119401488983405048096459109868560905463944665914306510760943936581475836297433932982612569992267742515031095449207081787518197335013711139017940591645274610067148589374832077938778749256045703212646584839968443636232443191331090162403685434256019179212372366767674219519885983500008561355416246365176280457478575924370099931126571426231349077936812090675312515814771195174591406655699070687709884145641340397280950270074970732125896668418778753530763084190793224580626929429533765386327799743228729493796069904475958629346852289107065248282016605159591105303792, 5414484819456665028266632069547681754467224225004109064785807020067544522990530972347632383603403284894049844970738937949961035381715067494475101173381966127002283893483014235393512179796855343308438415050555632391711318020249325993143577501272286554749066752714333419424100522761093081378828972523060159578302858229555400626453847679654873760780798410527177273113120068429790593175069339612620071085901766606801986383796035960844910334249499167382899841958583462319601313399956873526781409748580814767745784749949503782829126320636286974724537550303393768318547797059409828440561863147610341893716699105450866397626, 19541114464252109299610204400707232967621647981472144925161272289013230394061012968075197172687762455373366554195781314491598099625892632626983336662096842575835680521365789254054977704016578137137791369994819726759225501706478553269193351332398110543264428758235582156699116971137397852691163934533170137066109248619948331406146336989267456009603693307578775538641926205907156490839982504970535602757631542398213848609812478414414467726081653931710342107226135612425767816321038228531722145784520573345772533348024098882007494214586717674279469906019034569906706103455813253635719494306620677942168172567101901926715, 312669717200643390690031456285410193566788074515831920563707189848648465205759770154413829331819328356906512885719876140900866464277429977469636005431287922740635159537213037055288094167201610246169142211841833926128153776445002600950877243460268979615050289087091262378800260877999170651936516087758294401143791773054555545093311766461521716353657076799510244768956196788969090091865073802157033260735597164628734510931574948187883649954509014203723692091962062714225207418788279308757533529336266747757856479213249615407266911403572675783732163838109423094303219877954963596457990927318468036564203685403960882337, 3995412168849722728890418414058417429373078145364042849423472884807142122505794116800900261199574494390094235504174746048274612265424386251327378029951595897461905245373513006063146412253289439975858287243030714009690395275010218149344189159744050720840518450987986207700197862174931998867321319633978146062737672120254807548493326095383483600923929465398468915969772506906730136357036806587023691974531116068830512742791996473313297639936652880175314940973356203839362752821175324400323493060930507541472801871404492352732278572497424805798304057278640101271696209887149128815063980765712472978501389827217029882499, 6881227275775606295723625659261822759359618259271630996860018802174818677424090445269735308217966822316553135498577281887811536571726275260958973933510871903693778989490649564382748991302526045806014770015743285167966610935575017802398924237705124264389067729222945196834565528858777756155639189436785195015983841187462918951686708742073146663715210894962937821304713931222433560383041554825294451753128992391808956254783695814967042612044459104839457972460743864228452461893873431490698733594908745569786577218203835527203382635997602788530721857943113962549236951627975621623932656329510741444184804004245674105975, 11950595794343472279287810034090919757308617071423567079392759887143363315746128789970908201017383403358835210810356307858739767409977243162007592353117137228737273547927078571826488842198628179343688920441094889721948901647656774936092448861419641065307111681802259854578741019878755187181038854473659102058160473515629379323330408163334847228846505567081585474144056643891513138661203539857672417611238802800208535879586170389477098667312003019658694487020355326263417215387668184190910596006296707066830727025292126964382166629842473404932029949201086780848361310736398698685738231331282226966651261858277462704673, 18992462852337878541252034868053628913382824368339545779967642282802930396733910687304091326353017156948975941402937298476224195093934605016392407527754127800299506859290561473433812915142415189343597670932084929845500402008586484523567434322653870786603192168812332992256772320986337526228853667658078879645006095481264189195381147991563252826928519073129411403670430801975755414488851491152879905248306115366088950754945528646605031049205490726856031975529710910926231869466183279774110431385446074568352284857063460946946427033817860124017003437829192664869700891017134298383024122071558385138770399805265341866205, 9498455328198783900757091837556380561317162101573520140742998280455197455006295142315078560142752535554445330239192132968185646554396779714085025898742162330265560479980734230905792033137216908005419243442734806308975726075360059778446032561942079573822771271771701542382475724957180202131993076594106626421987574486722417429413950729870332037565494993656539001113731714791562473611012107583784549379275729024430896490175042004074655730848834980141317914634251449150392270206470268629875505566989349493666545163369199627050448003900659868142796139841161624959479283798228851432410026881445320619353884695401018951760, 9658997780618400028785885549378672205536301207728487830955859094414748808748145560781156458378122135426228178157424438260217799176681409013757576098623493111483442331448143606777219530667746298186759662891529148214882600997066626875545037365617350212858666029527607352776878110671436146458417822610354980941847670603843707515409007847835026665751118569294718112818252844326722091860530843481598032131197818612935541107981753309498516418042210560992035065188564128152450236054949662690163821972495513596866626383806139276948671102375637814677486648065137383535972504724574684933443415404162152191497667014636129377181]
	b = [2671117689282839325113403276203554990514994048743182753357193597423682610934420746800857441721450278964731423303462086292248630781199562937279502280990375677920467448440937108049903186809300553564408553770748133859191237629016681785242206990041777744610332785180122380692136741169631306731061897941007879415934223176452277309930095582476537712975093310637910122084346249518512304561430224229430069295955449069473201961743962291982823850883992019482760468058490829975443980576503857956625889023371933407004609788022658504116403644520318079282218481917350004738095653475361989652806715879213742499207692093171025701935, 2573728572144044565619308784280981745675019824539346346518942719201496844526674151023118493851073785848922639403920144826019309030547531797092937767199998473869858503447170395615810057660381086618020085462771461210465435395368638848618748286056878388392437943655002503658743963587939458739314406003917295962252348031717037307065191328015127092904091648418579809138449674320974709321049905638304745605742784355455747540246242828927944817294527010470629768125882127332248721893213840192304722035296331112570812797234965589202895425162009339999503817470019787514085768719445564683599904029299623797962680097786971879155, 13657721045771369400769837952742635907567263942034802902321203966536553544463425465853511741854157373702436228111431281217696002851212224868242966836069839030704418637227915046299840348947128519326260843509741512357524766455489188022016984845086373838089169447792450899417649478924034607094011499661496216691827963178552756572146204240695843490954141406792454478443846603507383621128846747794720572276377571970202097714386004470470395121516070682416087436733166257636821898955953258453382692627246817701281550442161489472521528398725975931880066579260059906136875993820956310129206716600349901023854647684043283506336, 2920766066575819566276605082657763784441252530805749491544801579429178896836660735325122872930958268252527995845807039053711249466969544491755191227227273234898763981888142915712343648313250535081849475307750711894703663759775772124447116171108851214743810777508934951342068218782762050110886051577012840150468442390858839279025208951663988024269311595245978661706435687837658536596524979508355811108369494457076497981154698761913529854119845886810056372129567191822954546634547039329446404689173662537470962220695209977109095456144968912127618932832334983857231092233690578241481009027159878278472599158348256510694, 74609471969661049094904742472024379221121041449555098484248184059177105592656476716051230872626561939427293596380673385296263348758516406108508657912458858575283921911533703689746750105368949897006057493067217316885302563615167097066153452197212048949409272302809146539252974334993911320834804546571868594174245344661891650480504799476525113049689919143656642349630575234778674482830823788339890914117526390652972502527961103810571065513285463604198693879094550565578632139794448441902498661302857441979351524698971469485666604394724636187901395117673622746371011520230012650326129486202019151013007006318791146686, 10712828309853307973316787446274297521910528606680792708714532240511087578449678349614565220069522642925511564759299647732781965173696203972168931940065376034577326205687018380559986187561279889507638167738350952728001019616067058590057863070380319706730807936963692700929444018757769240588318367172465879568794515931087986755558335222179087683804860217511863475477862430256577804744221362954482518458880979555833292750414621082276183960716897902159697461828210514680462468205276750990020566153140051813721887658657617611560162650464062807927434571711190223191809145162930410763389688419568267743110177739246508812211, 12894696726535069447739434633228136890322321485862320541793332702153105186380699283093384539084972625225257620988095377574811499466295881629864822004737881722812304127507051599436858496101897685533705655913150526578333408871305457174718452475626046223625372526154541955162350844611920451182943223762191514825478488178973303658826596316397096922690392582392345627622322196563497433493832295247128209744174482167535351480620809038323565675029394447111033267841018260373593302324254474657824011257971760800010124238955393550234361677902622223319851070587882490307500538036426179235739810162215185330075911507836414975112, 6844507227829741370302962198120975713786273979871393214066609673180675984556667664883595303196602637652172421809117847863610763183178938772048067481672940470764237421829650475369590205871502607987223241641705012762003224264846494143557024199728713659890498623944166968676191804057192078076976743746847449482398113417604851846630960352633904505106745432890921655550914232328670932590945307801719393395766007526495290774971607095671895922896454032509774420269006818801201883767450758708726162685986132140362930102209981639106776574111086178395568030929676814808538646031818126554823933071360674243302766383904957118882, 6481290370011873194751263299216305505088277113771980201557090860660571278037796163985786374522591487735349641025302408624383638410185879748447454281980266167569126364965217329167700129667419724894920154719979687665989556195248685222649685692030596089891639433966307880384970264798984703087307190280779596201669682585452203094370982082955075425176015674998846243414514657098295648056925003388830801799091954873827597925638557770748491940432711079782524797693992252449124793196309494214760501895353507121628885749797328767473601091530776133570350467370214475763658093956492125966216348967245005111325548483240366323305, 9767552037147193331253078957458572672540135922284699263958717032617734070102332847734563815707606569547306524795964142438684425849460079910471025718340525162214426376688981814018800602262959971160634323132708812549739987616343463791245141742899387247216053162366375983587640213176647660240405045041843943254572824407228328297011223262241164497452624658750267953359341145792220774127274781149437738286618564151487071472288934029584341712336748660465482967160495607144312901665267763329305886380735095661946689690728719294465126779844520928315444009334254886972756287587388935287466576026821407939174547995989736835450, 6750401588386425148990348824466791950024887382364549359370565166687722636188040522160492996108931916336077697012150072191305554245553459171539268556730576887976526429752049932276036034120052151621325088434815092026791797140886966238527880331187541097140809186276753804628563956334139851323798155646773144648730939162125194605199332209234255169883712020748143164030565527882979085511633445068875186929678342992975302670179578433604926403623383140686662952140468098633980354409098846979488070780330491738756942922858483285925655768925922687777310061921915157502190799343726815988646264513335617846095300443386392680828]
	c = [1087828240916547356687149383446323489376756283032870241162844312478110990048991800893022900913685619300029655498786770752263882077025980651896717161276720197762595146740360461729385026625055991068931549030285101445455007995962108552516177490578069242318530876540854422337114220573514166327686750098944202274102617963074469402807846364573136833172538203697554239380956717351168609794666593588681981312004748932980826375540617547973143663297889545026357198714770827975011817414339021104387126926980431832201184121073442735752971809563446367353945663537763239224827068534961316754365214112932030704994025668457728871525, 15306646829176360600266085736762109705529654025778898844832395703198734667054854237724096335553644822590533278112511918597105595068626623072802421674017159810507723307090362854974640808096391635132949994865246596587197877907015319856203516041397724872228874693199914495404768605241536819487797872868989190764101193754866911513042890174606650286432742067935995008298750207921949142310907814841986332257674362960197270666415736507918173081150524337579599329641989112097636221743234362356653448565318632162230031577399157871612062525704328342123669783057090585089506146669865517729433574059824677463555475187523121000068, 11948108373186116406337258425921837837044477614257030280127290295426541072229647215903239061407249200185963045796822173345773068140128262359153415592823196945092729875381662243838562269960161774199560260999590515196858286803584057262228556829185097831652517820160878827491924921367609432054016872326344256515928565286340573372690939525063866914726412308194909723799807473408172004418063178227210008949616867796431588050030378945333712887037155097315088509365105814046441704029079908993198023825337794218644633524250551919233440050757937354354074204604568238192695346646935696290250412661976937266939700568687339255810, 27880410645876999401171893907984730613804607629120642602737414895446445648293601414764826885206914257487099385808429019836993029260405575776820407082502987173568857478493180096675206763512746317482302355293568333319608636981434860468564393979895325318754444819174225223891947493692120989337496424178450270773458478807926463313009244303219740108741223020969761519123089403032058381230327177136966163200199187760566777243537097685819970456897246624087539519564905224801264768770567054734566833412231336756766912711408739814776811940797472003299334432857884714874064924648973901136145543696944304967414984519472924883148, 9830007353110248594981539547226823265560504159075129843322379524046015966327737798556980152671875396435446125042315750134756534934421053772376767786984448675831185215092069985894284855708405605586775601060743066965128364872321504035386463311176374051365722790389996283644722575309940511406455205660378609509074471666829092992284301796541595825090950172500776294550088346255143652238795083946116652640074617375161295015770204062915228350225048921705679287150649798437201800607524246444933518879916014668327250973547090574795586811993718324999252709967222430474470682978263715461499759548580932992123385543273309611135, 13789506354245758293354993028106500322392830412585367185060883680314022931356301721695805020309428957601140167733309081947033271486661339539321581510334366096540455923575847753081613600234439932750156644620516687701776536646196544647822114248790074735289570429671809360976202226338543790294491196084427685193983753827294705774921498233180030984507474648631876117858809400704425891115556768854837225428972343010434642951693202306131632789198146638657178885662506568738345525799159025440666975080624337826897284281476489305224951969398070375945142883123160481536530397150197338137129218926412629040462036061866191232167, 3642584780034485094054188079508851457452586922800096453391284321186589489234014636084897475105370009007977692860690562338721401009398085051134683754972440289716281726079947538322686835454200143684653176477294662786651851532702977072387543756889165401609298647444925153146613978941617382036868904522561259467885378330372899189610498483482001893666626298397485377415464464242421626422671900315339157810703184101126760888837582307933483539376915322491095984939542932769612823361028136192434140729227550091630613000717624194534597615432092782090949637630844866739048450714952631390761217874247201603927228899221350480477, 14629891066850653380259818936002082716790760397485191253273032796694758919301493518009630858358531476082896807212382142955802460761564314515120298436750824499896397313632008625592151936764918086190162094970901442013429821960160356579802146484619219998881444799901221662642163569441452928042059908314589976674106307113074667864227204361069900454799063684235290296632734427375890352743540518312720695797775888205802399409574086446609256540552232803371504702135585609725308237172502860177692012819806241492755740167980947819170205106459353296068693685755653813409810578673050155336084917108463793672687431871774039234773, 12911698048897018156826546122467210097524298204466208903757437341924185764662290668654973678512833012233101538241828306343084907274736740064405769331166675255155593406958605059213749790231989185764419867808872621074740371662373841072888254268954513058393751532778246858077647794482608555905846061329833754227156370274704509855873596957923564679172651891272716039659211511329526593605132572532358267664162547816855046327628086078388063374680358626451213049503423104366996253051807306798680014570203076983345956968760204468677126441334189287582642151794539739601625092268057144006043147148592230166662441925154476709228, 3673151411889695598138606058813272760384668018704942954062848119663386789561883943543883688574230730309754282773761562076438232236120657173098160254490492076850449532444282871980744065967503638875725690331312061213687273757771427500310990377757732863412200173445455586821552882840302454937415326438669781231520722741555623800833704022245586554292953508783744998706203664025808024818723966699834175897187566327074608377631446091822879965080467638157952305205318913329130910594396871909994703833262146462761351462291426525768536169016261269345754320124285971698857031617143951246260180891489846446580273678893116482056, 16415069713779378831752756725113948425959676212979904007885500235260735194791575045989338232384428345754827208420450263715811341155338758825905906420362640335745028089784375039815441726131846517192685390762573762143207832080683559274105037764091557881199640010855763198202091711197032735902573343776226808096505468807303724087691606679131975716068869808259901859666759481886892233567708831788684795002066180991121457682468329533354044219881610245575380628449400668190087194291941618155007166984257357346966873206726714031664509153159048243966105476309730004905720737559318397076048023871971234668900668083800404631219]
	n = [15756081187835350255574539816761139142681097942985712716710153936504012979209052415045863666554545932006487200989905167023492489767891688160379650646066916114697677515172751047351013198195924029342705053977972400555180970650309530738546820447136532168675339773444843246580734209034777962516866053981441986980658072596793606725141411351681064596340942509274923920929039410923947391270783043502214471618716131255449369984649437571269203866831070582623915179961246421528578167092878046893690311899008353023583701663885367687699034787221094234416414643585080361837044417068171205232380823405282313795834840224465652427961, 18209672583290938287572564535087733770530289727805233423410459696573771641193987712720863450878829165425552150931002799196514898066384396244536155997637406962447514139532452711734418142518963054298408473405289567338631588579230080847765570333338973359815008755384634683154016195736921169467044622026110194884959749672070322812204265970167433767758510385852305815295076667628525335747031157092594733797946464671177250237058783842813387759222935902859866882661446031978078227053339477866911376038996430018997409029986643163535305358851968524345308788479468949414304161520866935815096761226157956140572680810368125612597, 14905181520928269906658840307655018393644630809211184763756804746180298112130534470041131480037587301726305443573282198363192301889173543695547452955908900699504027702345511948711815924358543316389910368531307327806788073995953347042173492819099622826362828816653815380556762210910023726735880127797881745377154029704666392127508359319801960776713218623779062834473073458266522269130174196415138434007396307637780141824855511643158356797776585335197100407601436164652947761718610519276597708773155905292483922161411802311508057366552266283840333632700312139862795553344718160942211078396511591258813612573910011053363, 28252123431616093927315283416447368215274398560815578932282588072662671431612292064985726590604085915101829375761998616752589096540982007621766256324892727970764510010375095579924466238439936705544413760872378353917700144802715287450171724019441861787823744593597137940102303221028710228828732173377756371704502495012224570621485970988555346474806290331150979641293750066140854815051173580458112610709480775204317369399332636946315457920958679939231782391295491852438208687751209408583531582192682110756117838779015790206919990590106803490347389279311052776474864918992360330193473536343184984936566859882208522644569, 11808518097316450674626352006279893503259614520521203445326254346785667156485184815202500112554472316107180452384878707090959545679910562595930428377137324385651526822282769502469121215130015600614849828577827922753449259416181056903175315603361394790191035236188877928138116185245603495656382135434510228770215642825457479245683745844257426711851383651280488147094412750843369571934371173096180743785796108820810751606501132554361525257585158803856442331304434553694186683430838118926768698925818702146003599481529711054684004963926287560428691621951653283889690112722977476961911110844384216740094235019173856112801, 19850864388794655276403141115170226255438275661130460304289909293355002389259812265052464053973241758233829550123771172102633076383997397853092516949040364202523303799023816435911977052119597330519051959889145895114593229022118460149987304650116656206265097468676473280422131461880767049400394371698779537434325133703107037898308630527325708860674365477110904103358836599969265086420527986568148263722125257008790493548788826860046182519712577055250290687182311182054912400436736237319245028334212553378197872936146810852478147773055946823546649192261445727885039774855201323093664997572192628832183788248446450874619, 17963636587266292501745541865911391919649137980883484409866145147950050125823933897598040319740542497717656558401626838944267171751351472637406116348342209517040632220546985510764481319762281397456060701090539567680646027891334594277322384716872816814240120642109856050745344415880926008783953574056704309194757040563827596322582674215303714904404189118468692511137654541694859354384667472888093937816447882061154527136956310525578903580426064272356132922531921520801042342083430671846029869561246592182370528041258040836135919705671086764433063542516132148628798486598142473031123608329892642698172545860160687800751, 24211483076852899004277985101919522445825470022192931570744903210880755577011144273237848364495817097241812034694864252234027631509049416828248858837995499327840240312528906449232387322225658005561413724481648853224643250841197119933515953666268389207591041332279510099470257820027672292365897154979073005033975793854437283061954300139972810028112163161202003401905708158408220874170868892730499377445565410798348150665394075921865573355153968526925952817451071131027144364807903673314992115575636125810630084771137060234815998139703628719515691268204658315256195196122464414138177150717614970163245706199592175435979, 24060365815460762878504881947289325365754723990392984083347825185271109153501623316639343371037259660090045606619741030155051337801215700619081680332375557135715948321282162125923908925487580394069637707826620209477869785248971315237423535821749345592799022551529337429100344813487473733220172954106532227960685362706838174117751234459840195496560758645011035732593470598037530095401526697945924918976911381077903329237272034547886075306786117968793107422400613960240494430074195079442317195611919804617411255403293902365249941467471384749439775194643189440036748081424083043520303894223846195727348941927238303386591, 14765340213017563052550010169360793821738870726260225158451787922918746440472608597338294727398605589815601604972594249376301853013783986486480043371193511995133816004333563743595323853636833817310599848531601563352679882394531477160263038085837996834996162385829551784453697429338877273060257704635597192252654167377510231987564347135447408330172144868658912007111033808480753917560956585950167562742912255779228028905546050137460446047907722366809954375070785499661625798038332920814183264419274082186103717667139210729619674552885498103620138126377579819754824434524170153760337956128203692095921491525013042970847, 16947499801703518401312311261862423326052564948444684436288779331608707422258854824788255625396490702148689123224953381333640040890486608879028523260428558862488927248997190212899471368434826974696663711565140311204128345218433696180394831844747482297085478594799073049259738697995670674541413171511769849751958105633201146285681780781835090535839678278754171039193528029877129027816180090580796556339671547717430703217584335009651135025887279748391409946219689215452647761840707721673139163282092819001791156163165735051585362571299064824305171916944045059550764263910556280844097190580895661473266202118506656749231]
	count = 11

	m = [[0 for i in range(count)] for j in range(count)]
	for i in range(count):
		m[i][i] = 1
	t = []
	for i in range(count):
		t_i = crt(m[i], n)
		t.append(t_i)

	P.<x> = PolynomialRing(Zmod(prod(n)))

	g = 0
	for i in range(count):
		# gArray[i] = TArray[i]*(pow(aArray[i]*x + bArray[i],e) - cArray[i])
		g += t[i] * ((a[i] * x + b[i]) ** count - c[i] )



	g = g.monic()
	# print(g)
	# NOTE: PADDING MUST BE 1/13 OR SMALLER I THINK
	M = g.small_roots(epsilon = 1/13)
	return M[0]
	# print(long_to_bytes(M))

def main():
	print(long_to_bytes(bespoke_padding()))


if __name__ == '__main__':
	main()



